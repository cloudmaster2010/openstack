# Introduction
This guide describes things like the following:   
1. Demonstrate how to set external network with br-ex bridge and physical interface.          
2. Manage network, vm with dashboared.     
   - Login
   - Create public network
   - Create private network
   - Create router
   - Add interfaces to router
   - Create two VM with public and private network
3. Network connection test with CLI   
   - Priavate network test
   - Public network test
   - Add a rule to be ping available

# Setting external network with br-ex bridge and physical interface.
#### Adding port(ens4) to the external bridge(br-ex)
```sh
ovs-vsctl --may-exist add-br br-ex -- set bridge br-ex \
  protocols=OpenFlow13
```

#### Mapping pubilc:br-ex to go though external.
```sh
ovs-vsctl set open . external-ids:ovn-bridge-mappings=public:br-ex
ovs-vsctl --may-exist add-port br-ex ens4
```
#### Creating external network named public.
```sh
openstack network create --external --share \
  --provider-physical-network public --provider-network-type flat \
  public
```
#### Creating ip range for external network.
```sh
openstack subnet create --network public --subnet-range \
  192.168.103.0/24 --allocation-pool start=192.168.103.151,end=192.168.103.160 \
  --dns-nameserver 8.8.8.8 --gateway 192.168.103.1 public-sub
```  

# Manage network, vm with dashboared.
#### network environment:   
  - public network :    
    name : public   
    subnet : 192.168.103.0/24   
    IP Allocation Pools : Start 192.168.103.151 - End 192.168.103.160   
    Gateway IP : 192.168.103.1   
  - private network :    
    name : 55-net   
    subnet : 55.55.55.0/24   
    IP Allocation Pools : Start 55.55.55.2 - End 55.55.55.254   
  - router :   
    name : router   
    interfaces : 55.55.55.1(Internal Interface), 192.168.103.160(External Gateway) 
  - network topology:   
 ![network topolgy page](./images/2.topology.png)   
  - network topology graph:   
 ![network topology graph page](./images/2.topology-graph.png)  


### 1. Network Page   
![network page](./images/2.networks.png)


### 2. Router Page   
![router page](./images/2.routers.png)

### 3. Router Interfaces Page   
![router page](./images/2.ineterfaces.png)

### 4. Instances Page   
![instance page](./images/2.instances.png)

# Network connection test with CLI 
   - Priavate network test
```sh
openstack server list -c Name -c Networks
+----------+--------------------------------------+
| Name     | Networks                             |
+----------+--------------------------------------+
| cirros-2 | 55-net=192.168.103.157, 55.55.55.104 |
| cirros-1 | 55-net=192.168.103.158, 55.55.55.137 |
+----------+--------------------------------------+

virsh list
 Id   Name                State
-----------------------------------
 1    instance-00000006   running
 2    instance-00000007   running
 
virsh dumpxml 1 | grep nova:name
      <nova:name>cirros-1</nova:name>

virsh console 1
Connected to domain instance-00000006
Escape character is ^]

login as 'cirros' user. default password: 'gocubsgo'. use 'sudo' for root.
cirros-1 login: cirros
Password: 
$ ip -4 -o a
1: lo    inet 127.0.0.1/8 scope host lo\       valid_lft forever preferred_lft forever
2: eth0    inet 55.55.55.137/24 brd 55.55.55.255 scope global eth0\       valid_lft forever preferred_lft forever
--- 55.55.55.104 ping statistics ---
4 packets transmitted, 4 packets received, 0% packet loss
round-trip min/avg/max = 0.372/0.790/1.751 ms
$ ping -c 3 55.55.55.104
PING 55.55.55.104 (55.55.55.104): 56 data bytes
64 bytes from 55.55.55.104: seq=0 ttl=64 time=0.544 ms
64 bytes from 55.55.55.104: seq=1 ttl=64 time=0.594 ms
64 bytes from 55.55.55.104: seq=2 ttl=64 time=0.678 ms

--- 55.55.55.104 ping statistics ---
3 packets transmitted, 3 packets received, 0% packet loss
round-trip min/avg/max = 0.544/0.605/0.678 ms

```

   - Public network test
   - Add a rule to be ping available



